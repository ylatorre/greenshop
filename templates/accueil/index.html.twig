{% extends 'base.html.twig' %}

{% block title %}Accueil!{% endblock %}

{% block body %}


    {% include './composant/Header.html.twig' %}

    <body class=" bg-orange-100">

        <div class="relative z-48  h-[90vh] top-0 flex flex-col justify-center items-center">
            <!-- Conteneur de l'image -->
            <div class="w-full md:w-3/4 h-3/4 md:h-2/3 bg-no-repeat bg-center" style="background-image: url('https://media.discordapp.net/attachments/1153601406339661886/1212416782166397058/pexels-kelly-4030637.jpg?ex=65f1c21e&is=65df4d1e&hm=20d1f5326f6b585e953a4872762b1f91514dccf8a2b7fdea1ee2e5a50d6456e1&=&format=webp&width=2087&height=1172');">
                <!-- Le texte commence ici, au-dessus de l'image -->
                <div id="floatingText" class="absolute top-0 left-1/2 w-full justify-center -translate-y-full flex flex-col items-center">
                    <h2 class="text-4xl md:text-5xl xs:text-3xl text-orange-100 text-center font-extrabold">
                        La plateforme de vente en ligne éco-responsable. <br>- déchet <br>+ de produits.
                    </h2>
                    <h2 class="text-xl md:text-2xl xs:text-xl text-orange-100 mt-2 md:mt-5 text-center font-semibold">
                        Notre objectif est de sensibiliser à la cause environnementale et de promouvoir un mode de vie durable.
                    </h2>
                    <button class="mt-2 md:mt-4 rounded border-2 border-orange-200 px-4 md:px-7 pb-[4px] md:pb-[8px] pt-[6px] md:pt-[10px] text-xs md:text-sm font-medium uppercase leading-normal text-orange-100 transition duration-150 ease-in-out hover:border-neutral-100 hover:bg-neutral-500 hover:bg-opacity-10 hover:text-neutral-100">
                        Shop Now
                    </button>
                </div>
            </div>
        </div>

        <script>
            document.addEventListener('scroll', function() {
                var scrollPosition = window.scrollY;
                var textElement = document.getElementById('floatingText');
                var imageContainer = textElement.parentElement;
                var imageHeight = imageContainer.offsetHeight;
                var imageOffsetTop = imageContainer.offsetTop;
                var textElements = textElement.querySelectorAll('h2, button'); // Sélectionne tous les éléments de texte et le bouton
                var extraDistance = 130; // Ajustez cette valeur selon vos besoins
                var textPosition = scrollPosition + window.innerHeight / 2 - imageOffsetTop;

                if (scrollPosition + window.innerHeight / 2 <= imageOffsetTop + imageHeight + extraDistance) {
                    textElement.style.transform = `translate(-50%, ${textPosition}px)`;
                    if (scrollPosition + window.innerHeight / 2 <= imageOffsetTop + imageHeight) {
                        textElements.forEach(el => {
                            el.classList.remove('text-neutral-900');
                            el.classList.add('text-orange-100');
                        });
                    } else {
                        textElements.forEach(el => {
                            el.classList.remove('text-orange-100');
                            el.classList.add('text-neutral-900');
                        });
                    }
                } else {
                    let translateYValue = (imageHeight + extraDistance) - imageOffsetTop + window.innerHeight / 2 - textElement.offsetHeight / 2;
                    textElement.style.transform = `translate(-50%, ${translateYValue}px)`;
                }
            });
        </script>

        <style>
        .card:hover .arrow-svg {
            transform: translateX(10px);
            transition: transform 0.3s ease-in-out;
        }
        </style>

        <!--Affichage dynamique des catégories-->
        <div class="w-screen xs:mt-72 mt-96 flex justify-around">
            <div class="w-11/12 h-1/3 flex flex-col sm:flex-row justify-around items-center">
                {% for categorie in categories %}
                    {% set imageFileName = imagesParCategorie[categorie.id] ?? 'default.jpg' %}
                    <div class="flex flex-col mb-4 w-72 shadow-lg">
                        <div>
                            <img src="{{ asset('/image/produits/' ~ imageFileName) }}" class="h-56 w-full" alt="Image de {{ categorie.nom }}">
                        </div>
                        <div>{{ categorie.nom }}</div>
                    </div>
                {% endfor %}
            </div>
        </div>


        <!--Affichage semi-dynamique produits "Les plus vendus"-->
        <div class="h-screen w-screen flex-col justify-center items-center">
            <div class="w-screen flex items-center justify-center">
                <h1 class="text-xl text-green-800 my-8 w-11/12 ">
                    Top Vente
                </h1>
            </div>
            <div class="flex justify-center gap-4">
                {% for produit in produitsPlusVendus|slice(0, 4) %}
                    <div class="flex flex-col items-center w-44 h-64 p-2.5 rounded border border-gray-400 border-opacity-50">
                        <img  alt="{{ produit.titre }}" class="w-32 h-32 object-contain p-2">
                        <div class="flex flex-col items-center space-y-3">
                            <a  class="text-xs mt-2 text-center font-medium">{{ produit.titre }}</a>
                            <span class="text-xs font-thin">{{ produit.description }}</span>
                        </div>
                    </div>
                {% endfor %}
            </div>
            <div id="produits-cache" class="hidden">
                {% for produit in produitsPlusVendus|slice(4, 4) %}
                    <div class="flex flex-col items-center w-44 h-64 p-2.5 rounded border border-gray-400 border-opacity-50">
                        <img  alt="{{ produit.titre }}" class="w-32 h-32 object-contain p-2">
                        <div class="flex flex-col items-center space-y-3">
                            <a  class="text-xs mt-2 text-center font-medium">{{ produit.titre }}</a>
                            <span class="text-xs font-thin">{{ produit.description }}</span>
                        </div>
                    </div>
                {% endfor %}
            </div>
            <h2 class="voir-plus text-green-800 font-semibold text-sm underline text-center mt-4 cursor-pointer">Voir plus</h2>

            <script>
                document.querySelector('.voir-plus').addEventListener('click', function() {
                    document.getElementById('produits-cache').classList.remove('hidden');
                    this.classList.add('hidden'); // Cache le bouton "Voir plus" après le clic
                });
            </script>
            {# <span class="text-xs font-semibold">Prix: {{ produit.prix }} €</span>
            href="{{ path('path_to_product_detail', {'id': produit.id}) }}"
            src="{{ produit.pathToImage }}" #}

            <!-- Affichage semi-dynamique produits "Mieux notés"-->
            <div class="h-screen w-screen flex-col justify-center items-center">
                <div class="w-screen flex items-center justify-center">
                    <h1 class="text-xl text-green-800 my-8 w-11/12 ">
                        Mieux notés
                    </h1>
                </div>
                <div class="flex justify-center gap-4">
                    {% for produit in produitsMieuxNotes|slice(0, 4) %}
                        <div class="flex flex-col items-center w-44 h-64 p-2.5 rounded border border-gray-400 border-opacity-50">
                            <img  alt="{{ produit.titre }}" class="w-32 h-32 object-contain p-2">
                            <div class="flex flex-col items-center space-y-3">
                                <a  class="text-xs mt-2 text-center font-medium">{{ produit.titre }}</a>
                                <span class="text-xs font-thin">{{ produit.description }}</span>
                            </div>
                        </div>
                    {% endfor %}
                </div>
                <div id="produits-cache-mieux-notes" class="hidden">
                    {% for produit in produitsMieuxNotes|slice(4, 4) %}
                        <div class="flex flex-col items-center w-44 h-64 p-2.5 rounded border border-gray-400 border-opacity-50">
                            <img  alt="{{ produit.titre }}" class="w-32 h-32 object-contain p-2">
                            <div class="flex flex-col items-center space-y-3">
                                <a  class="text-xs mt-2 text-center font-medium">{{ produit.titre }}</a>
                                <span class="text-xs font-thin">{{ produit.description }}</span>

                            </div>
                        </div>
                    {% endfor %}
                </div>

                <h2 class="voir-plus-mieux-notes text-green-800 font-semibold text-sm underline text-center mt-4 cursor-pointer">Voir plus</h2>

                <script>
                    document.querySelector('.voir-plus-mieux-notes').addEventListener('click', function() {
                        document.getElementById('produits-cache-mieux-notes').classList.remove('hidden');
                        this.classList.add('hidden'); // Cache le bouton "Voir plus" après le clic
                    });
                </script>

                <script>
                    function carouselNext() {
                        const container = document.querySelector('.flex');
                        const shownItems = document.querySelectorAll('.flex-shrink-0:not(.hidden)');
                        const nextIndex = Math.min(shownItems.length, 5);
                        container.style.transform = `translateX(-${
                        nextIndex * 100
                        }%)`;
                        }

                        function carouselPrev() {
                        const container = document.querySelector('.flex');
                        container.style.transform = 'translateX(0)';
                    }
                </script>
            </div>
        </div>
    </body>
{% endblock %}




