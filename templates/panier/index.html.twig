{% block title %}{% endblock %}

{% block body %}

{% include './composant/Header.html.twig' %}
    <div class="flex flex-col sm:flex-row w-full  sm:mt-72 h-screen">
        <div class="w-full sm:w-1/6"></div>
        <div class="w-full sm:w-5/6 px-4 sm:px-0">
            <div class="flex flex-col sm:flex-row items-center justify-between text-xl ">
                <h1 class="text-4xl sm:text-7xl text-gray-900 font-bold mb-4 sm:mb-0">Panier</h1>
            </div>
            

    
    {% if panier %}
    <ul>
        {% for ficheProduit in panier.getFicheProduits %}
            <li>
                {{ ficheProduit.titre }} - Prix : {{ ficheProduit.prix }} €
                {# Ajoutez d'autres détails de ficheProduit selon votre besoin #}
            </li>
        {% endfor %}
    </ul>
    <h2>Prix Total: {{ prixTotal }} €</h2>
{% else %}
    <div class="text-gray-900 mt-8 sm:mt-20">
                <h2 class="text-3xl sm:text-5xl font-semibold">Historique des commandes</h2>
                <h2 class="text-xl sm:text-2xl font-light">Vous n'avez pas encore passé de commande.</h2>
            </div>
{% endif %}
        </div>
        <button id="checkout-button" class="bg-green-800 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transform transition hover:scale-105 duration-300 ease-in-out">
    Payer
</button>
    </div>
{% include './composant/bottomBar.html.twig' %}


</div>
<script src="https://js.stripe.com/v3/"></script>
    
</body>
</html>

<script>
var stripe = Stripe('pk_test_51OfQTfIt7t0x5dTglGHreq6TfXNXoTLuXW9HOvi24as0oEkvSxzXWNZBuYwfS9rnbVNFs8umnJRkDdEtIQo9FBTZ00h6Y2jXk2');

var checkoutButton = document.getElementById('checkout-button');
checkoutButton.addEventListener('click', function () {
    // Créer une session de paiement sur le serveur (voir étape dans le contrôleur Symfony)
    fetch('/create-checkout-session', {
        method: 'POST',
    })
    .then(function (response) {
        return response.json();
    })
    .then(function (session) {
        console.log("Session ID:", session.id); // Afficher le Session ID pour le débogage
        if (!session.id) {
            throw new Error("Session ID not found in response");
        }
        return stripe.redirectToCheckout({ sessionId: session.id });
    })
    .catch(function (error) {
        console.error("Error:", error);
    });
});



</script>

{% endblock %}